"""OpenCTI Vulnerability models"""

from typing import List

from typing_extensions import Literal, TypedDict

from .opencti_common import FilterMode

__all__ = [
    "VulnerabilityOrdering",
    "VulnerabilityFilter",
    "VulnerabilityFiltering",
    "ImportVulnerabilityExtras",
]

VulnerabilityFilter = Literal[
    "name",
    "x_opencti_aliases",
    "x_opencti_base_score",
    "x_opencti_base_severity",
    "x_opencti_attack_vector",
    "created",
    "modified",
    "created_at",
    "createdBy",
    "markedBy",
    "labelledBy",
    "x_opencti_workflow_id",
]


class VulnerabilityFiltering(TypedDict):
    key: VulnerabilityFilter
    values: List[str]
    operator: str
    filterMode: FilterMode


VulnerabilityOrdering = Literal[
    "name",
    "x_opencti_base_score",
    "x_opencti_base_severity",
    "x_opencti_attack_vector",
    "created",
    "modified",
    "created_at",
    "updated_at",
    "x_opencti_workflow_id",
]


class ImportVulnerabilityExtras(TypedDict, total=False):
    created_by_id: str
    object_marking_ids: List[str]
    object_label_ids: List[str]
    external_references_ids: List[str]
